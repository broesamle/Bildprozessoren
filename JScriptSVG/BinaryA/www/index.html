<!DOCTYPE html>
<html lang="de">
<head> 
<meta charset="utf-8">
<meta name="author" content="Martin BrÃ¶samle">
<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<link rel="stylesheet" type="text/css" href="./start.css">
<link rel="stylesheet" type="text/css" href="style.css">
<title>WysiwyC: Visual Binary Table</title>
</head>
<body class="mainpage">
<h1>WysiwyC: Visual Binary Table</h1>
<p>
Challenge: Create a graphical binary table using <q>graphical instructions</q>.<br>
<a href="" onclick="return addSpaceToAllBits()" title="Add space between all bits.">Space between</a>&nbsp;|&nbsp;
<a href="" onclick="return addBitToAllBits()" title="Add a double size bit to all bits.">Double to all</a>&nbsp;|&nbsp;
<a href="" onclick="return addSpaceToAllBytes()" title="Add space to bits of equal length to the uppermost bit.">Space <q>uppermost-sized</q></a>&nbsp;|&nbsp;
<a href="" onclick="return addBitToAllBytes()" title="Add a double size bit to bits of equal length to the uppermost bit.">Double to <q>uppermost-sized</q></a>&nbsp;|&nbsp;
<a href="" onclick="return copymoveRightDownAll()" title="Coppy all bits to the right and down.">Copy all right-down</a>
</p>
<div class="fullsizecontainer">
<svg viewBox="0 0 64 64" class="visualbyte" style="background:#cccccc;" >
<rect x="0" y="0" width="1" height="1"/>
<rect x="1" y="1" width="1" height="1"/>
</svg>
</div>
<script>
function getAllRectsArray() {
	var allrects = document.getElementsByTagName("rect");
	var rectsarr = [];
	for(var i = 0, n; n = allrects[i]; ++i) rectsarr.push(n);
	return rectsarr;
}

function movedownRect(rect) {
	rect.setAttribute('y', parseInt(rect.getAttribute("y"))+1);
}

function addSpaceToAllBits() {	
	var rectsarr = getAllRectsArray()
	
	while (rectsarr.length > 0) {
		rectsarr.map(movedownRect);
		rectsarr.shift();
	}
	return false;
}

function addBitToAllBits() {
	var rectsarr = getAllRectsArray()
	var template = rectsarr[0].cloneNode()

	template.setAttribute("width",parseInt(template.getAttribute("width"))*2);	
	function f (rect) {
		var x = parseInt(rect.getAttribute("x"));
		var y = parseInt(rect.getAttribute("y"));
		var clon = template.cloneNode();
		clon.setAttribute("y",y-1);
		rect.parentNode.insertBefore(clon,rect);
	} 
	rectsarr.map(f);
	return false;
}

function addSpaceToAllBytes() {
	var rectsarr = getAllRectsArray()
	var wi = rectsarr[0].getAttribute("width")
	while (rectsarr.length > 0) {
		rectsarr.map(movedownRect);
		rectsarr.shift();
		while (rectsarr.length > 0 && rectsarr[0].getAttribute("width") != wi ) {
			rectsarr.shift();
		}
	}
	return false;
}

function addBitToAllBytes() {
	var rectsarr = getAllRectsArray();
	var template = rectsarr[0].cloneNode();
	var wi = rectsarr[0].getAttribute("width");
	
	template.setAttribute("width",parseInt(template.getAttribute("width"))*2);
	
	function f (rect) {
		var x = parseInt(rect.getAttribute("x"));
		var y = parseInt(rect.getAttribute("y"));
		var clon = template.cloneNode();
		if (rect.getAttribute("width") == wi) {
			clon.setAttribute("y",y-1);
			rect.parentNode.insertBefore(clon,rect);
		}
	}	 
	rectsarr.map(f);
	return false;
}

function copymoveRightDownAll() {
	var rectsarr = getAllRectsArray();	
	var deltaX = parseInt(rectsarr[0].getAttribute("width"));
	var deltaY = parseInt(rectsarr[rectsarr.length-1].getAttribute("y"))+1;

	function f(rect) {
		var clon = rect.cloneNode()
		clon.setAttribute('x', parseInt(rect.getAttribute("x"))+deltaX);
		clon.setAttribute('y', parseInt(rect.getAttribute("y"))+deltaY);
		rect.parentNode.appendChild(clon)
	}		
	rectsarr.map(f);
	return false;
}
</script>
</body>
</html>
